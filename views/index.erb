<!doctype html>  
<html lang="en">  
<head>  
  <meta charset="utf8">  

  <title>Tubbyracer</title>  
</head>  
<body>  

  <header>  


    <h1>TubbyRacer!</h1>  


  </header>  

  <div id="main">  
    <!--    <p> Random Paragraph </p> -->
    <form action="/" method="post">

      <p id="paragraph"><%= @paragraph %></p>
      <textarea name="input" id="input" onkeyup="listen()"></textarea>
    </form> 
      <button onclick='start()'>Start!</button>
  </div>  
  
  <script type="text/javascript">
    var input = document.getElementById('input');
    var text = document.getElementById('paragraph').innerText
    var start_time = 0;
    var done = false
    // var finish = document.getElementsByName('submit')[0];

    // input.onfocus = function(){
    //   start_time = new Date();
    //   console.log("input:" + start_time)
    // };
    // finish.onclick = function(){
    //   finish_time = new Date();
    //   console.log("finish:" + finish_time)
    //   total_time = finish_time - start_time;
    //   alert("Congrats! You took" + " " + (total_time/1000) + " " + "seconds.")
    // }
    function start() {
      setTimeout(function() {start_time = new Date()},2000);
      // return start_time
    }

    function listen() {
      // console.log(input.value)
      var regex = new RegExp(input.value)
      // console.log(regex)
      if (text.match(regex)) { console.log(true) }
        else { console.log(false) }
      if (text === input.value && done === false) {
        var finish_time = new Date()
        var total_time = (finish_time - start_time) / 1000
        alert("Congrats! You typed at " + parseInt(wpm(total_time)) + " words per minute!" )
        done = true
      }
      }

    function wpm(time) {
      var wordsPerMinute = text.split(" ").length / (time / 60)
      return wordsPerMinute
    }

  </script>

  <footer>  

  </footer>  
</body>  
</html>  
